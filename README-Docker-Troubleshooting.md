# üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º Docker

## ‚ùå –û—à–∏–±–∫–∞ 'ContainerConfig'

### –ü—Ä–æ–±–ª–µ–º–∞

```
ERROR: 'ContainerConfig'
KeyError: 'ContainerConfig'
```

### –ü—Ä–∏—á–∏–Ω–∞

–≠—Ç–∞ –æ—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–º–∏ —Ç–æ–º–∞–º–∏ –≤ Docker Compose –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω–æ–≥–æ –∫—ç—à–∞ Docker.

### –†–µ—à–µ–Ω–∏–µ

#### 1. –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ - –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–ø—Ä–æ—â–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –±–µ–∑ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–º–æ–≤:

```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–ø—Ä–æ—â–µ–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
docker-compose -f docker-compose.dev.yml up -d
```

#### 2. –û—á–∏—Å—Ç–∫–∞ Docker –∫—ç—à–∞

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down -v

# –û—á–∏—Å—Ç–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –∫—ç—à
docker system prune -a -f

# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ç–æ–º–∞
docker volume prune -f

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑—ã
docker-compose build --no-cache
```

#### 3. –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker (–∫—Ä–∞–π–Ω–∏–π —Å–ª—É—á–∞–π)

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è, –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker Desktop.

## üöÄ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –∑–∞–ø—É—Å–∫–∞

### 1. –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ Docker)

```bash
# –ü—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –∑–∞–ø—É—Å–∫–∞ –±–µ–∑ Docker
./start-local.sh
```

### 2. –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –°–±–æ—Ä–∫–∞ React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
npm run build

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ API (–≤ –æ–¥–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
node server.js

# –ó–∞–ø—É—Å–∫ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ (–≤ –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
npx serve -s build -l 3000
```

### 3. –†–∞–∑—Ä–∞–±–æ—Ç—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º

```bash
# API —Å–µ—Ä–≤–µ—Ä (–≤ –æ–¥–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
node server.js

# React dev server (–≤ –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
npm start
```

## üîß –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å Docker
docker info

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker ps

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞–∑—ã
docker images

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–º–∞
docker volume ls
```

### –õ–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
docker-compose logs

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker-compose logs -f

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose logs photo-pwa
```

## üõ†Ô∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π docker-compose.yml

```yaml
version: "3.8"

services:
  photo-pwa:
    build: .
    ports:
      - "3000:3000"
      - "3001:3001"
    volumes:
      - ./uploads:/app/uploads
    environment:
      - NODE_ENV=production
    restart: unless-stopped
```

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π Dockerfile

```dockerfile
FROM node:18-alpine
WORKDIR /app

# –ö–æ–ø–∏—Ä—É–µ–º package.json
COPY package*.json ./
RUN npm install

# –ö–æ–ø–∏—Ä—É–µ–º server-package.json
COPY server-package.json ./
RUN mkdir server && cp server-package.json server/package.json
RUN cd server && npm install

# –ö–æ–ø–∏—Ä—É–µ–º –∫–æ–¥
COPY . .

# –°–æ–±–∏—Ä–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
RUN npm run build

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º serve
RUN npm install -g serve

EXPOSE 3000 3001
CMD ["./start.sh"]
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker stats

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
docker system df

# –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
docker system df -v
```

### –û—á–∏—Å—Ç–∫–∞ –º–µ—Å—Ç–∞

```bash
# –û—á–∏—Å—Ç–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –æ–±—Ä–∞–∑—ã
docker image prune -f

# –û—á–∏—Å—Ç–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker container prune -f

# –û—á–∏—Å—Ç–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–æ–º–∞
docker volume prune -f

# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
docker system prune -a -f
```

## üîÑ –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

### docker-quick-rebuild.sh

–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏:

```bash
#!/bin/bash
echo "‚ö° –ë—ã—Å—Ç—Ä–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º Docker
if ! docker info > /dev/null 2>&1; then
    echo "‚ùå Docker –Ω–µ –∑–∞–ø—É—â–µ–Ω. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Docker Desktop."
    exit 1
fi

# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏ –æ—á–∏—â–∞–µ–º
docker-compose down 2>/dev/null
docker system prune -f > /dev/null 2>&1

# –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º
docker-compose build --no-cache
docker-compose up -d

echo "‚úÖ –ì–æ—Ç–æ–≤–æ! http://localhost:3000"
```

## üö® –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. Docker –Ω–µ –∑–∞–ø—É—â–µ–Ω

```
Cannot connect to the Docker daemon
```

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ Docker Desktop

### 2. –ü–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã

```
Error: Port 3000 is already in use
```

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å
lsof -i :3000

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
kill -9 <PID>
```

### 3. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞

```
no space left on device
```

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –û—á–∏—Å—Ç–∏—Ç—å Docker
docker system prune -a -f

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Å—Ç–æ
df -h
```

### 4. –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞

```
Permission denied
```

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ uploads
sudo chown -R $USER:$USER uploads/

# –ò–ª–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É
rm -rf uploads && mkdir uploads
```

## üìã –ß–µ–∫-–ª–∏—Å—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

- [ ] Docker Desktop –∑–∞–ø—É—â–µ–Ω
- [ ] –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ (>2GB)
- [ ] –ü–æ—Ä—Ç—ã 3000 –∏ 3001 —Å–≤–æ–±–æ–¥–Ω—ã
- [ ] –§–∞–π–ª—ã package.json –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- [ ] –ü–∞–ø–∫–∞ uploads —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- [ ] –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- [ ] –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

## üÜò –≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:

```bash
# 1. –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ Docker
docker system prune -a -f --volumes

# 2. –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –æ–±—Ä–∞–∑—ã –ø—Ä–æ–µ–∫—Ç–∞
docker rmi $(docker images "pwaexample*" -q) 2>/dev/null

# 3. –ó–∞–ø—É—Å–∫ –±–µ–∑ Docker
./start-local.sh
```
