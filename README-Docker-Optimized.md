# üê≥ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

```bash
docker-compose up -d
```

### –ë—ã—Å—Ç—Ä–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ (—Ç–æ–ª—å–∫–æ –∫–æ–¥, –±–µ–∑ npm install)

```bash
./docker-quick-rebuild.sh
```

–∏–ª–∏

```bash
docker-compose down && docker-compose build && docker-compose up -d
```

### –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ (—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)

```bash
./docker-rebuild.sh
```

## üîß –ß—Ç–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ

### 1. –ú–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω–∞—è —Å–±–æ—Ä–∫–∞ (Multi-stage build)

- **dependencies** - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–∫—ç—à–∏—Ä—É–µ—Ç—Å—è –µ—Å–ª–∏ package.json –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è)
- **builder** - —Å–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞)
- **production** - —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ –¥–ª—è –∑–∞–ø—É—Å–∫–∞

### 2. Docker Layer Caching

- `node_modules` –∫—ç—à–∏—Ä—É—é—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–ª–æ–µ
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Å–ª–æ–π —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- –ë—ã—Å—Ç—Ä–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–æ–ª—å–∫–æ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞

### 3. –ò–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–º–∞

- `node_modules_cache` - –∫—ç—à –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `server_node_modules_cache` - –∫—ç—à –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Å–µ—Ä–≤–µ—Ä–∞
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ node_modules

### 4. .dockerignore

- –ò—Å–∫–ª—é—á–∞–µ—Ç –Ω–µ–Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–±–æ—Ä–∫–∏
- –£—Å–∫–æ—Ä—è–µ—Ç –ø–µ—Ä–µ–¥–∞—á—É –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ Docker daemon

## üìä –í—Ä–µ–º—è —Å–±–æ—Ä–∫–∏

| –°—Ü–µ–Ω–∞—Ä–∏–π               | –í—Ä–µ–º—è      | –û–ø–∏—Å–∞–Ω–∏–µ                     |
| ---------------------- | ---------- | ---------------------------- |
| –ü–µ—Ä–≤–∞—è —Å–±–æ—Ä–∫–∞          | ~3-5 –º–∏–Ω   | –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π |
| –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–¥–∞         | ~30-60 —Å–µ–∫ | –¢–æ–ª—å–∫–æ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ React      |
| –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π | ~2-3 –º–∏–Ω   | –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞   |

## üõ†Ô∏è –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose down

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞
docker-compose ps

# –û—á–∏—Å—Ç–∫–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–±—Ä–∞–∑–æ–≤
docker system prune

# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (–≤–∫–ª—é—á–∞—è —Ç–æ–º–∞)
docker-compose down -v
docker system prune -a
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤–∫–ª—é—á–∞–µ—Ç healthcheck, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥.

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–¥–æ—Ä–æ–≤—å—è
docker-compose ps
```

## üåê –î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é

- **React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: http://localhost:3000
- **API —Å–µ—Ä–≤–µ—Ä**: http://localhost:3001
- **–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã**: —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `./uploads` (–º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ volume)

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞

```bash
sudo chown -R $USER:$USER uploads/
```

### –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ—Ä—Ç–∞–º–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–Ω—è—Ç—ã–µ –ø–æ—Ä—Ç—ã
lsof -i :3000
lsof -i :3001

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
sudo kill -9 <PID>
```

### –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ Docker

```bash
docker builder prune
docker-compose build --no-cache
```
